---
title: "Group Project 4 COVID"
author: 'covid_p11'
date: '2022-03-28'
output:
  html_document:
    toc: true
    number_sections: false
    theme: flatly
    highlight: tango
    toc_float: true
    toc_depth: 4
    code_folding: hide
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(maps)
library(plotly)
library(caret)
library(dplyr)
```

Topic: COVID-19 New cases
visualisation dashboard: Shiny app
```{r}
covid = read.csv("owid-covid-data.csv")
glimpse(covid)
```

# data clean
```{r}
covid_clean = covid %>% drop_na(new_cases, new_cases_smoothed, total_deaths, new_deaths, new_deaths_smoothed, total_cases_per_million, new_cases_per_million, new_cases_smoothed_per_million, total_deaths_per_million, new_deaths_per_million, new_deaths_smoothed_per_million, new_vaccinations, new_vaccinations_smoothed, new_vaccinations_smoothed_per_million, population, population_density, median_age,extreme_poverty, new_tests, new_people_vaccinated_smoothed)
glimpse(covid_clean)
unique(covid_clean$location)
```

# Impact on finicial market

# relationship between new cases and vaccination

# Initial analysis for new_cases_smoothed
```{r}
covid_temp <- covid_clean
covid_temp$month <- strftime(covid_temp$date, "%m")
covid_temp$year  <- strftime(covid_temp$date, "%Y")

covid_temp_new_case_aggregate <- aggregate(new_cases_smoothed~month+year, 
                  covid_temp,
                  FUN = mean)
covid_temp_new_case_aggregate$month_year <- paste(covid_temp_new_case_aggregate$month, covid_temp_new_case_aggregate$year)
```

```{r}
ggplot(covid_temp_new_case_aggregate, aes(x= new_cases_smoothed, y= month_year)) +
  geom_bar(stat = 'identity') + ggtitle("Average New Cases (Smoothed) per Month") +
  ylab("month year") + xlab("average new cases")
```

- Analysis: From the above bar plot, we set different months of 2021 and 2022 as y-axis and the average smoothed new cases for each month as x-axis. We can easily know that smoothed new cases in most months are less than 30,000 except in Jan, 2022, which is nearly 50,000. So the data of new_cases_smoothed is evenly distributed and has a small standard deviation.

# Initial analysis for new_people_vaccinated_smoothed
```{r}
covid_temp = covid_clean %>% select(date,new_people_vaccinated_smoothed)
covid_temp$date <- as.Date(covid_temp$date, format = "%Y-%m-%d")
covid_temp_new_vaccinated_aggregate = covid_temp %>% mutate(month_year = as.character(format(date, "%m-%Y"))) %>%
          group_by(month_year) %>%
  summarise(date=date[1], number = mean(new_people_vaccinated_smoothed))
covid_temp_new_vaccinated_aggregate  
```

```{r}
ggplot(covid_temp_new_vaccinated_aggregate, aes(x = number, y= month_year)) +
  geom_bar(stat = 'identity') + ggtitle("Average New People Vaccinated (Smoothed) per Month") +
  ylab("month year") + xlab("average new people vaccinated")
```

- Analysis: Most number show above are larger than 100000. Many people get vaccinated in July, August and September in 2021, and less people get vaccinated before and after that period which is reasonable since it takes time to invent and promote new vaccines.